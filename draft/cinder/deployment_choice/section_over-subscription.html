<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Over-Subscription and Thin-Provisioning</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../../_static/css/combined.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../../_static/bespoke.css" type="text/css" />
<link rel="stylesheet" href="../../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-86037601-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>

<!-- SOURCE_FILE: https://github.com/NetApp-openstack-dev/openstack-docs/cinder/deployment_choice/section_over-subscription.rst -->

 <script type="text/javascript">
    (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
                (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
    })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

    _st('install','aDn5L_vgZ2yzRcE893kK','2.0.0');
</script>
<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="http://netapp.io/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
         <form class="docs-main-search-form">
    <input type="text" class="st-default-search-input custom-search-box" placeholder="Search OpenStack">
</form>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
           <li>
    <input type="text" class="st-default-search-input custom-search-box-mobile" placeholder="Search OpenStack">
</li>
        </li>
        <li>
          <a class="drop" id="dropdownMenuSoftware">Social Media <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://https://www.github.com/netapp">github/netapp</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://netapp.io/slack">slack</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://twitter.com/@openstacknetapp">twitter/@openstacknetapp</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.youtube.com/user/NetAppTV">youtube/users/NetAppTV</a></li>
          </ul>
        </li>
        <li>
          <a class="drop" id="dropdownMenuSoftware">Upstream Docs <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ocata/install-guide-rdo/cinder.html">Cinder Documentation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ocata/install-guide-rdo/glance.html">Glance Documentation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/project-install-guide/shared-file-systems/ocata/">Manila Documentation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ocata/install-guide-rdo/nova.html">Nova Documentation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/project-install-guide/object-storage/ocata/">Swift Documentation</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Over-Subscription and Thin-Provisioning</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="section_service-catalog.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Using Cinder Volume Types to Create a Storage Service Catalog"></i></a>
    
    
    <a href="section_unidirectional-chap.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Unidirectional CHAP Authentication"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-08-28 16:05</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Over-Subscription and Thin-Provisioning</a><ul>
<li><a class="reference internal" href="#data-ontap-thin-provisioning">Data ONTAP Thin Provisioning</a></li>
<li><a class="reference internal" href="#e-series-thin-provisioning">E-Series Thin Provisioning</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="over-subscription-and-thin-provisioning">
<h1>Over-Subscription and Thin-Provisioning<a class="headerlink" href="#over-subscription-and-thin-provisioning" title="Permalink to this headline">¶</a></h1>
<p>When a thick-provisioned Cinder volume is created, an amount of space is
reserved from the backend storage system equal to the size of the
requested volume. Because users typically do not actually consume all
the space in the Cinder volume, overall storage efficiency is reduced.
With thin-provisioned Cinder volumes, on the other hand, space is only
carved from the backend storage system as required for actual usage. A
thin-provisioned Cinder volume can grow up to its nominal size, but for
space-accounting only the actual physically used space counts.</p>
<p>Thin-provisioning allows for over-subscription because you can present
more storage space to the hosts connecting to the storage controller
than is actually currently available on the storage controller. As an
example, in a 1TB storage pool, if four 250GB thick-provisioned volumes
are created, it would be necessary to add more storage capacity to the
pool in order to create another 250GB volume, even if all volumes are at
less than 25% utilization. With thin-provisioning, it is possible to
allocate a new volume without exhausting the physical capacity of the
storage pool, as only the utilized storage capacity of the volumes
impacts the available capacity of the pool.</p>
<p>Thin-provisioning with over-subscription allows flexibility in capacity
planning and reduces waste of storage capacity. The storage
administrator is able to simply grow storage pools as needed to fill
capacity requirements.</p>
<p>As of the Liberty release, all NetApp drivers conform to the standard
Cinder scheduler-based over-subscription framework as described
<a class="reference external" href="http://docs.openstack.org/admin-guide-cloud/blockstorage_over_subscription.html">here</a>,
in which the <code class="docutils literal"><span class="pre">max_over_subscription_ratio</span></code> and <code class="docutils literal"><span class="pre">reserved_percentage</span></code>
configuration options are used to control the degree of
over-subscription allowed in the relevant storage pool. Note that the
Cinder scheduler only allows over-subscription of a storage pool if the
pool reports the <em>thin-provisioning-support</em> capability, as described
for each type of NetApp platform below.</p>
<p>The default <code class="docutils literal"><span class="pre">max_over_subscription_ratio</span></code> for all drivers is 20.0, and
the default <code class="docutils literal"><span class="pre">reserved_percentage</span></code> is 0. With these values and
<em>thin-provisioning-support</em> capability on (see below), if there is 5TB
of actual free space currently available in the backing store for a
Cinder pool, then up to 1,000 Cinder volumes of 100GB capacity may be
provisioned before getting a failure, assuming actual physical space
used averages 5% of nominal capacity.</p>
<div class="section" id="data-ontap-thin-provisioning">
<h2>Data ONTAP Thin Provisioning<a class="headerlink" href="#data-ontap-thin-provisioning" title="Permalink to this headline">¶</a></h2>
<p>In Data ONTAP multiple forms of thin-provisioning are possible. By
default, the <code class="docutils literal"><span class="pre">nfs_sparsed_volumes</span></code> configuration option is True, so
that files that back Cinder volumes with our NFS drivers are sparsely
provisioned, occupying essentially no space when they are created, and
growing as data is actually written into the file. With block drivers,
on the other hand, the default <code class="docutils literal"><span class="pre">netapp_lun_space_reservation</span></code>
configuration option is ‘enabled’ and the corresponding behavior is to
reserve space for the entire LUN backing a cinder volume. For
thick-provisioned Cinder volumes with NetApp drivers, set
<code class="docutils literal"><span class="pre">nfs_sparsed_volumes</span></code> to False. For thin-provisioned Cinder volumes
with NetApp block drivers, set <code class="docutils literal"><span class="pre">netapp_lun_space_reservation</span></code> to
‘disabled’.</p>
<p>With Data ONTAP, the flexvols that act as storage pools for Cinder
volumes may themselves be thin-provisioned since when these flexvols are
carved from storage aggregates this may be done without space
guarantees, i.e. the flexvols themselves grow up to their nominal size
as actual physical space is consumed.</p>
<p>Data ONTAP drivers report the <em>thin-provisioning-support</em> capability if
either the files or LUNs backing cinder volumes in a storage pool are
thin-provisioned, or if the flexvol backing the storage pool itself is
thin-provisioned. Note that with Data ONTAP drivers, the
<em>thin-provisioning-support</em> and <em>thick-provisioning-support</em>
capabilities are mutually-exclusive.</p>
</div>
<div class="section" id="e-series-thin-provisioning">
<h2>E-Series Thin Provisioning<a class="headerlink" href="#e-series-thin-provisioning" title="Permalink to this headline">¶</a></h2>
<p>E-Series thin-provisioned volumes may only be created on Dynamic Disk
Pools (DDP). They have 2 different capacities that are relevant: virtual
capacity, and physical capacity. Virtual capacity is the capacity that
is reported by the volume, while physical (repository), capacity is the
actual storage capacity of the pool being utilized by the volume.
Physical capacity must be defined/increased in 4GB increments. Thin
volumes have two different growth options for physical capacity:
automatic and manual. Automatically expanding thin volumes will increase
in capacity in 4GB increments, as needed. A thin volume configured as
manually expanding must be manually expanded using the appropriate
storage management software.</p>
<p>With E-series, thin-provisioned volumes and thick-provisioned volumes
may be created in the same storage pool, so the
<em>thin-provisioning-support</em> and <em>thick-provisioning-support</em> may both be
reported to the scheduler for the same storage pool.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="8%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Extra spec</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">max_over_subscription_ratio</span></code></td>
<td><code class="docutils literal"><span class="pre">20.0</span></code></td>
<td>A floating point representation of the oversubscription ratio when thin-provisioning is enabled for the pool.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">reserved_percentage</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>Percentage of total pool capacity that is reserved, not available for provisioning.</td>
</tr>
</tbody>
</table>
<p>Table 4.12. NetApp supported configuration options for use with
Over-Subscription</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="section_service-catalog.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Using Cinder Volume Types to Create a Storage Service Catalog"></i></a>
          
          
            <a href="section_unidirectional-chap.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Unidirectional CHAP Authentication"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-08-28 16:05</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://netapp.io/slack/" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
<a href="../../index.html">
  <button href="#" type="button"
          class="btn docs-sidebar-release-select">NetApp OpenStack Docs 2017.2</button>
</a>

  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <h4></h4>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ch_executive-summary.html">Executive Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_openstack-overview.html">OpenStack Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_netapp-storage.html">NetApp Systems and Software</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../ch_cinder.html">Block Storage (Cinder)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-key-concepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-processes.html">Process Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-api-overview.html">API Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../section_cinder-deployment-choices.html">Theory of Operation and Deployment Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../section_cinder-examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_glance-image-service.html">Image Service (Glance)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_manila.html">Shared Filesystems (Manila)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_nova.html">Compute Service (Nova)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_swift.html">Object Storage (Swift)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ch_operations.html">Operational Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/appendix_packaging.html">Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/appendix_debug.html">Troubleshooting</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>NetApp Support</h3>
        <ul>
          <li><a href="https://community.netapp.com//">NetApp Community Forums</a></li>
          <li><a href="https://mysupport.netapp.com/">NetApp Support</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>News & Blogs</h3>
        <ul>
          <li><a href="http://planet.openstack.org/">Commnunity Blog</a></li>
          <li><a href="http://openstack.org/news/">Community News</a></li>
          <li><a href="http://netapp.io/blog/">thePub Blog</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Upstream Documentation</h3>
        <ul>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Legal</h3>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../../_static/js/jquery-3.1.1.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "cinder/deployment_choice/section_over-subscription" + ".rst";
        gitURL = "Source: https://github.com/NetApp-openstack-dev/openstack-docs" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: aadfd06a71f6ec1d9f56ed75918af7288a9be518";
        var bugProject = "NetApp-openstack-dev/openstack-docs";
        var bugTitle = "Over-Subscription and Thin-Provisioning in NetApp OpenStack Docs";
    var fieldTags = "docs, dog";
        var useStoryboard = "";


    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 2017.2 on 2017-08-28 16:05";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

  </body>
</html>